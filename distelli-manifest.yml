slv/rototiller:
  PreBuild:
    - echo "docker info:"
    - docker info
    - echo "logging into PCR..."
    - docker login -u TOKEN --password $PCR_TOKEN pcr-internal.puppet.net
    - echo "pulling container image"
    - docker pull pcr-internal.puppet.net/slv/rototiller:latest
    - echo "gem install rototiller yard rubocop flog flay roodi rubycritic"
    - gem install rototiller

  Build:
    # something in here (docker probably) is reading from stdin
    #   this prevents subsequent steps from running (acceptance doesn't run)
    #   so we need the </dev/null :facepalm:
    - echo "rake docs:verify" </dev/null
    - rake docs:verify
    - echo "rake lint:flay" </dev/null
    - rake lint:flay
    - echo "rake lint:flog" </dev/null
    - rake lint:flog
    #- echo "rake lint:rubocop" </dev/null
    #- rake lint:rubocop
    - echo "rake test:unit" </dev/null
    - rake test:unit </dev/null
    - echo "rake test:acceptance" </dev/null
    - rake test:acceptance </dev/null
